
<div class="row">
  <div class="col-11 offset-1">
    <div class="row">
      <div class="col-11" style="height: 300px;">
        <% @chalet.photos.each do |photo| %>
          <%= cl_image_tag photo.key, height: 250, width: 250, crop: :fill %>
        <% end %>
      </div>
    </div>
    <div class="row">
      <div class="col-7">
        <%= @chalet.description%><br>
        <%= @chalet.address %><br>
        <%= @chalet.number_of_guests %> people<br>
        <%= @chalet.number_of_bedrooms %> bedroom<br>
        Â£<%= @chalet.price %> per night
      </div>
      <div class="col-4">
        <%= simple_form_for [@chalet, @booking] do |f| %>
          <%= f.input :check_in_date %>
          <%= f.input :check_out_date %>
          <%= f.input :number_of_guests %>
          <%= f.submit %>
        <% end %>
      </div>
    </div>
    <div class="row">
      <div class="col-11 offset-1">

      <script src='https://api.mapbox.com/mapbox-gl-js/v1.7.0/mapbox-gl.js'></script>
      <div id='map' style='width: 100%; height: 100%;'></div>
        <% token = "pk.eyJ1IjoicGlvdHItZGUiLCJhIjoiY2s2YzdpcngxMDgydzNscXh6NGUwMXpwdCJ9.zU1s4Q3hB2Jz-3mqbRcAng" %>
        <% url = "https://api.mapbox.com/geocoding/v5/mapbox.places/#{@chalet.address.gsub("\s", "%20")}.json?access_token=#{token}" %>
        <% coords = JSON.parse(RestClient.get(url))["features"][0]["center"] %>
    <script>
      mapboxgl.accessToken = 'pk.eyJ1IjoicGlvdHItZGUiLCJhIjoiY2s2YzdpcngxMDgydzNscXh6NGUwMXpwdCJ9.zU1s4Q3hB2Jz-3mqbRcAng';
      var map = new mapboxgl.Map({
      center: <%= coords %>,
      zoom: 12,
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v11'
      });
      var marker = new mapboxgl.Marker()
        .setLngLat(<%= coords %>)
        .addTo(map);
    </script>
  </div>

      </div>
    </div>
  </div>
</div>
